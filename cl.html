<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T·∫øt Fair 2026 - T√†i X·ªâu Leaderboard</title>
    <style>
        body {
            background: radial-gradient(circle, #b22222, #4b0000);
            color: #ffd700;
            font-family: 'Segoe UI', Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            gap: 20px;
        }

        /* M√†n h√¨nh nh·∫≠p t√™n ph·ªß l√™n tr√™n */
        #login-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        #login-overlay input {
            padding: 15px;
            font-size: 1.2rem;
            border-radius: 10px;
            border: 2px solid #ffd700;
            background: #222;
            color: #fff;
            margin-bottom: 15px;
            width: 250px;
            text-align: center;
        }

        /* Container ch√≠nh */
        .game-container {
            text-align: center;
            background: rgba(0, 0, 0, 0.9);
            padding: 30px;
            border: 4px solid #ffd700;
            border-radius: 30px;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
            width: 350px;
        }

        .leaderboard {
            background: rgba(0, 0, 0, 0.85);
            padding: 20px;
            border: 2px solid #ffd700;
            border-radius: 20px;
            width: 250px;
        }

        .dice-area { display: flex; justify-content: center; gap: 10px; margin: 20px 0; }
        .dice {
            width: 65px; height: 65px; background: #fff; color: #222;
            font-size: 2.2rem; font-weight: bold; display: flex;
            justify-content: center; align-items: center; border-radius: 10px;
        }

        .infinite-shake { animation: shake 0.1s infinite alternate; }
        @keyframes shake { from { transform: translateY(-3px); } to { transform: translateY(3px); } }

        .btn {
            width: 48%; padding: 12px; font-size: 1.1rem; font-weight: bold;
            cursor: pointer; border: none; border-radius: 10px; color: white;
        }
        .tai { background: #e63946; } .xiu { background: #457b9d; }
        
        .btn-start, .btn-end {
            background: #ffd700; color: #000; padding: 12px 25px;
            border-radius: 10px; font-weight: bold; cursor: pointer; border: none;
        }
        .btn-end { width: 100%; margin-top: 20px; }
        .disabled { opacity: 0.3; cursor: not-allowed; }

        .leaderboard-list { list-style: none; padding: 0; text-align: left; font-size: 0.9rem; }
        .leaderboard-list li {
            padding: 8px 0; border-bottom: 1px dashed #555;
            display: flex; justify-content: space-between;
        }
    </style>
</head>
<body>

    <div id="login-overlay">
        <h1 style="color: #ffd700; margin-bottom: 30px;">üßß T·∫æT FAIR 2026 üßß</h1>
        <input type="text" id="player-name-input" placeholder="Nh·∫≠p t√™n c·ªßa b·∫°n...">
        <button class="btn-start" onclick="startGame()">B·∫ÆT ƒê·∫¶U CH∆†I</button>
    </div>

    <div class="game-container" id="main-box">
        <h2 style="margin: 0;">T√ÄI X·ªàU</h2>
        <div style="margin-bottom: 20px; opacity: 0.8;">Ng∆∞·ªùi ch∆°i: <span id="display-name" style="color:#fff">...</span></div>
        
        <div class="dice-area">
            <div id="dice-1" class="dice">?</div>
            <div id="dice-2" class="dice">?</div>
            <div id="dice-3" class="dice">?</div>
        </div>

        <div style="height: 70px;">
            <div id="outcome">ƒê·∫∑t c∆∞·ª£c ƒë·ªÉ l·∫Øc x√≠ ng·∫ßu!</div>
            <h3 id="total-score" style="margin: 5px 0;">T·ªïng: ?</h3>
        </div>

        <div style="display: flex; justify-content: space-between; margin: 20px 0;">
            <button id="btn-tai" onclick="startRolling('Tai')" class="btn tai">T√ÄI</button>
            <button id="btn-xiu" onclick="startRolling('Xiu')" class="btn xiu">X·ªàU</button>
        </div>

        <div style="font-size: 1.4rem; font-weight: bold;">
            S·ªë d∆∞: <span id="balance" style="color: #00ff00;">1000</span> xu
        </div>
        
        <button onclick="endGame()" class="btn-end">K·∫æT TH√öC & L∆ØU BXH</button>
    </div>

    <div class="leaderboard">
        <h3 style="text-align: center;">üèÜ BXH CAO TH·ª¶</h3>
        <ul id="leaderboard-list" class="leaderboard-list"></ul>
    </div>

    <script>
        let balance = 1000;
        let isRolling = false;
        let currentBet = "";
        let currentPlayer = "";
        let clickCount = 0;
        let clickTimer = null;
        let rollInterval = null;

        // C·∫≠p nh·∫≠t BXH t·ª´ m√°y ngay khi load trang
        window.onload = updateLeaderboardDisplay;

        // B·∫ÆT ƒê·∫¶U CH∆†I (·∫®n overlay)
        function startGame() {
            const name = document.getElementById('player-name-input').value.trim();
            if (!name) {
                alert("B·∫°n vui l√≤ng nh·∫≠p t√™n ƒë·ªÉ BTC ghi nh·∫≠n nh√©!");
                return;
            }
            currentPlayer = name;
            balance = 1000;
            document.getElementById('display-name').innerText = currentPlayer;
            document.getElementById('balance').innerText = balance;
            document.getElementById('login-overlay').style.display = 'none';
        }

        // L·∫ÆC V√î T·∫¨N
        function startRolling(bet) {
            if (isRolling) return;
            isRolling = true;
            currentBet = bet;

            document.getElementById('outcome').innerText = "ƒêang l·∫Øc... ƒê·ª£i Admin ch·ªët!";
            document.getElementById('btn-tai').classList.add('disabled');
            document.getElementById('btn-xiu').classList.add('disabled');

            const diceEls = [document.getElementById('dice-1'), document.getElementById('dice-2'), document.getElementById('dice-3')];
            diceEls.forEach(d => d.classList.add('infinite-shake'));

            rollInterval = setInterval(() => {
                diceEls.forEach(d => d.innerText = Math.floor(Math.random() * 6) + 1);
            }, 80);
        }

        // ADMIN CH·ªêT PH√çM A
        document.addEventListener('keydown', (e) => {
            if (e.key.toLowerCase() === 'a' && isRolling) {
                clickCount++;
                clearTimeout(clickTimer);
                clickTimer = setTimeout(() => {
                    const box = document.getElementById('main-box');
                    if (clickCount === 2) { box.style.borderColor = "#ff4e50"; finishGame("Tai"); }
                    else if (clickCount === 3) { box.style.borderColor = "#457b9d"; finishGame("Xiu"); }
                    setTimeout(() => { box.style.borderColor = "#ffd700"; }, 500);
                    clickCount = 0;
                }, 400); 
            }
        });

        function finishGame(forced) {
            clearInterval(rollInterval);
            let d1, d2, d3;
            if (forced === "Tai") { d1 = 5; d2 = 6; d3 = Math.floor(Math.random() * 3) + 2; }
            else { d1 = 1; d2 = 2; d3 = Math.floor(Math.random() * 3) + 1; }

            const total = d1 + d2 + d3;
            const resultText = (total >= 11) ? "Tai" : "Xiu";

            const diceEls = [document.getElementById('dice-1'), document.getElementById('dice-2'), document.getElementById('dice-3')];
            diceEls[0].innerText = d1; diceEls[1].innerText = d2; diceEls[2].innerText = d3;
            diceEls.forEach(d => d.classList.remove('infinite-shake'));

            document.getElementById('total-score').innerText = `T·ªïng: ${total} (${resultText === 'Tai' ? 'T√†i' : 'X·ªâu'})`;

            if (currentBet === resultText) {
                document.getElementById('outcome').innerText = "üéä B·∫†N TH·∫ÆNG R·ªíI!";
                balance += 100;
            } else {
                document.getElementById('outcome').innerText = "üßß MAY M·∫ÆN L·∫¶N SAU!";
                balance -= 100;
            }
            document.getElementById('balance').innerText = balance;
            isRolling = false;
            document.getElementById('btn-tai').classList.remove('disabled');
            document.getElementById('btn-xiu').classList.remove('disabled');
        }

        // K·∫æT TH√öC V√Ä HI·ªÜN L·∫†I OVERLAY
        function endGame() {
            if (isRolling) return;
            
            let history = JSON.parse(localStorage.getItem('tetFairLeaderboard')) || [];
            history.push({ name: currentPlayer, score: balance });
            history.sort((a, b) => b.score - a.score);
            localStorage.setItem('tetFairLeaderboard', JSON.stringify(history.slice(0, 10)));
            
            updateLeaderboardDisplay();
            document.getElementById('player-name-input').value = "";
            document.getElementById('login-overlay').style.display = 'flex';
            
            // Reset giao di·ªán game
            document.getElementById('dice-1').innerText = "?";
            document.getElementById('dice-2').innerText = "?";
            document.getElementById('dice-3').innerText = "?";
            document.getElementById('total-score').innerText = "T·ªïng: ?";
            document.getElementById('outcome').innerText = "ƒê·∫∑t c∆∞·ª£c ƒë·ªÉ l·∫Øc x√≠ ng·∫ßu!";
        }

        function updateLeaderboardDisplay() {
            let history = JSON.parse(localStorage.getItem('tetFairLeaderboard')) || [];
            const listEl = document.getElementById('leaderboard-list');
            listEl.innerHTML = history.map((item, index) => 
                `<li><span>${index + 1}. ${item.name}</span> <span>${item.score}</span></li>`
            ).join('');
        }
    </script>
</body>
</html>